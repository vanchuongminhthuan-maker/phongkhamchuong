<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quản lý Phòng Khám</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="mb-4">Quản lý phòng khám</h1>

    <div class="row g-4">
      <!-- Thêm bệnh nhân -->
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-header fw-semibold">Thêm bệnh nhân</div>
          <div class="card-body">
            <form action="/add_patient" method="POST" class="row g-2">
              <div class="col-12">
                <label class="form-label">Họ tên *</label>
                <input name="name" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Ngày sinh</label>
                <input name="dob" class="form-control" placeholder="dd/mm/yyyy">
              </div>
              <div class="col-md-6">
                <label class="form-label">SĐT</label>
                <input name="phone" class="form-control" placeholder="09xxxxxxxx">
              </div>
              <div class="col-12">
                <button class="btn btn-primary mt-2">Lưu</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Nhập thuốc -->
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-header fw-semibold">Nhập thuốc</div>
          <div class="card-body">
            <form action="/add_medicine" method="POST" class="row g-2">
              <div class="col-12">
                <label class="form-label">Tên thuốc *</label>
                <input name="name" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Dạng</label>
                <input name="form" class="form-control" placeholder="viên/gói/lọ...">
              </div>
              <div class="col-md-6">
                <label class="form-label">Số lượng</label>
                <input type="number" name="quantity" class="form-control" min="0" value="0">
              </div>
              <div class="col-md-6">
                <label class="form-label">Đơn giá</label>
                <input type="number" step="0.01" name="price" class="form-control" min="0" value="0">
              </div>
              <div class="col-md-6">
                <label class="form-label">Tổng giá vốn</label>
                <input type="number" step="0.01" name="total_cost" class="form-control" min="0" value="0">
              </div>
              <div class="col-12">
                <button class="btn btn-success mt-2">Nhập</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Bệnh nhân hôm nay -->
    <div class="card shadow-sm mt-4">
      <div class="card-header fw-semibold">Bệnh nhân hôm nay</div>
      <div class="card-body">
        {% if patients %}
          <div class="table-responsive">
            <table class="table table-striped align-middle">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Họ tên</th>
                  <th>Ngày sinh</th>
                  <th>SĐT</th>
                  <th>Thời gian tạo</th>
                </tr>
              </thead>
              <tbody>
                {% for p in patients %}
                  <tr>
                    <td>{{ p.id }}</td>
                    <td>{{ p.name }}</td>
                    <td>{{ p.dob or '-' }}</td>
                    <td>{{ p.phone or '-' }}</td>
                    <td>
                      {% if p.created_at %}
                        {{ (p.created_at).strftime('%Y-%m-%d %H:%M') }}
                      {% else %}
                        -
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-muted mb-0">Chưa có bệnh nhân nào hôm nay.</p>
        {% endif %}
      </div>
    </div>

    <!-- Tìm kiếm bệnh nhân -->
    <div class="card shadow-sm mt-4">
      <div class="card-header fw-semibold">Tìm kiếm bệnh nhân</div>
      <div class="card-body">
        <div class="row g-2">
          <div class="col-md-6">
            <input id="search" class="form-control" placeholder="Nhập tên cần tìm...">
          </div>
          <div class="col-md-6">
            <button id="btnSearch" class="btn btn-outline-primary">Tìm</button>
          </div>
        </div>
        <ul id="results" class="list-group
